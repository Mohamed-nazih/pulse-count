<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PulseCount</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;800&family=Rajdhani:wght@500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#050510">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --primary: #00f3ff;
            --secondary: #bc13fe;
            --bg-dark: #050510;
            --glass: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --glass-highlight: rgba(255, 255, 255, 0.05);
            /* New highlight for 3D feel */
            --shadow-light: rgba(0, 243, 255, 0.3);
            --text-color: #ffffff;
            --danger: #ff2a6d;
            --calib-color: #ffaa00;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            /* Prevent selection for app-like feel */
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-color);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background-color 0.5s, color 0.5s;
        }

        /* Themes */
        body.theme-neon {
            --primary: #00f3ff;
            --secondary: #bc13fe;
            --bg-dark: #050510;
        }

        body.theme-forest {
            --primary: #00ff9d;
            --secondary: #bfdbfe;
            --bg-dark: #021a0f;
            --shadow-light: rgba(0, 255, 157, 0.3);
        }

        body.theme-ember {
            --primary: #ff5e00;
            --secondary: #ff004c;
            --bg-dark: #1a0505;
            --shadow-light: rgba(255, 94, 0, 0.3);
        }

        body.theme-gold {
            --primary: #ffd700;
            --secondary: #ffec8b;
            --bg-dark: #121002;
            --shadow-light: rgba(255, 215, 0, 0.3);
        }

        body.theme-light {
            --primary: #007bff;
            --secondary: #00d2ff;
            --bg-dark: #f0f2f5;
            --text-color: #1a1a2e;
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(0, 0, 0, 0.1);
            --shadow-light: rgba(0, 123, 255, 0.2);
        }

        body.theme-light .counter-val {
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #1a1a2e;
        }

        body.theme-light .control-btn {
            color: #333;
        }

        body.theme-light .icon-btn {
            color: #555;
        }

        body.theme-light .icon-btn:hover {
            color: var(--primary);
        }

        body.theme-light .history-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        body.theme-light .history-meta {
            color: #666;
        }

        body.theme-light .modal-card,
        body.theme-light .dialog-card {
            background: #fff;
            color: #333;
            border: 1px solid #ddd;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        body.theme-light .modal-title,
        body.theme-light .dialog-title {
            color: #333;
        }

        body.theme-light .dialog-msg {
            color: #666;
        }

        body.theme-light .dialog-input {
            background: #f5f5f5;
            color: #333;
            border: 1px solid #ddd;
        }

        body.theme-light .dialog-btn-cancel {
            border: 1px solid #ccc;
            color: #555;
        }

        /* Light Theme Overrides */
        body.theme-light .background-fx {
            background: linear-gradient(135deg, #f0f2f5 0%, #dbe4ef 100%) !important;
        }

        body.theme-light .orb {
            opacity: 0;
        }

        body.theme-light .scanlines {
            opacity: 0.05;
            background-size: 100% 3px;
        }

        body.theme-light .counter-box {
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow:
                0 10px 30px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.8),
                0 0 0 1px rgba(0, 0, 0, 0.05);
        }

        body.theme-light .counter-box::before {
            background: rgba(255, 255, 255, 0.5);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        body.theme-light .counter-val {
            color: #1a1a2e;
            text-shadow:
                0 2px 0 rgba(0, 0, 0, 0.1),
                0 5px 15px rgba(0, 0, 0, 0.05);
        }

        body.theme-light .plus-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #fff;
            color: var(--primary);
            box-shadow:
                0 15px 35px rgba(0, 123, 255, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.5);
        }

        body.theme-light .plus-btn:active {
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
            background: #fff;
        }

        body.theme-light .control-btn {
            background: #fff;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            color: #555;
        }

        body.theme-light .logo {
            color: #333;
        }

        body.theme-light .logo span {
            color: var(--primary);
        }

        body.theme-light .status-badge {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            border: 1px solid #e0e0e0;
        }

        body.theme-light .instruction {
            color: #777;
        }

        body.theme-light .progress-ring__circle {
            filter: drop-shadow(0 0 2px rgba(0, 123, 255, 0.5));
        }

        body.theme-light .goal-input {
            background: #f5f5f5;
            color: #333;
            border: 1px solid #e0e0e0;
        }

        body.theme-light .goal-input::placeholder {
            color: #999;
        }

        /* Milestone Visuals */
        body.milestone-hit .counter-val {
            color: var(--primary);
            text-shadow: 0 0 50px var(--primary);
            transform: scale(1.2) rotateX(360deg) !important;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Animated Background */
        .background-fx {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #050510 100%);
            overflow: hidden;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            animation: float 10s infinite ease-in-out;
        }

        .orb-1 {
            width: 300px;
            height: 300px;
            background: var(--primary);
            top: -50px;
            left: -50px;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: var(--secondary);
            bottom: -100px;
            right: -100px;
            animation-delay: -5s;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(30px, 50px);
            }
        }

        /* Scanline effect */
        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.2) 50%, rgba(0, 0, 0, 0.2));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }

        /* Container */
        .app-container {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 2rem 1.5rem 3rem 1.5rem;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1rem;
        }

        .logo {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.7);
        }

        .header-controls {
            display: flex;
            gap: 15px;
        }

        .icon-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .icon-btn:hover {
            color: var(--primary);
        }

        /* Modals */
        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-card {
            background: var(--bg-dark);
            border: 1px solid var(--glass-border);
            width: 85%;
            max-width: 400px;
            max-height: 80%;
            border-radius: 20px;
            padding: 20px;
            color: #fff;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform 0.3s;
            overflow-y: auto;
        }

        .modal-overlay.open .modal-card {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: 10px;
        }

        .modal-title {
            font-family: 'Rajdhani';
            font-weight: 700;
            font-size: 1.5rem;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--danger);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* History List */
        .history-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .history-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.9rem;
        }

        .history-meta {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75rem;
        }

        .history-val {
            color: var(--primary);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* History Selection */
        .history-list.selecting .history-item {
            padding-left: 40px;
            position: relative;
        }

        .history-check {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border-radius: 5px;
            border: 2px solid var(--primary);
            appearance: none;
            cursor: pointer;
            display: none;
        }

        .history-check:checked {
            background: var(--primary);
            box-shadow: inset 0 0 0 4px var(--bg-dark);
        }

        .history-list.selecting .history-check {
            display: block;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .btn-select-history {
            background: none;
            border: 1px solid var(--glass-border);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .btn-delete-selected {
            background: var(--danger);
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.8rem;
            display: none;
        }

        /* Settings Grid */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .theme-opt {
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--glass-border);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .theme-opt.active {
            border-color: var(--primary);
            background: var(--glass);
        }

        .goal-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .goal-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            padding: 10px;
            border-radius: 8px;
            color: #fff;
        }

        /* Progress Ring Container */
        .plus-btn-container {
            position: relative;
            width: 120px;
            height: 120px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .progress-ring {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
            pointer-events: none;
        }

        .progress-ring__circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
            stroke: var(--primary);
            filter: drop-shadow(0 0 4px var(--primary));
        }

        .status-badge {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 6px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .status-badge.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary);
            box-shadow: 0 0 5px var(--primary);
        }

        /* Counter Display */
        .counter-wrapper {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
            width: 100%;
            padding: 2rem 0;
        }

        .counter-box {
            position: relative;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.01) 100%);
            border-radius: 30px;
            padding: 3rem 2rem;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

            /* 3D Glass Border Effect */
            border: 1px solid var(--glass-border);
            box-shadow:
                inset 0 0 20px rgba(0, 0, 0, 0.5),
                /* Inner shadow for depth */
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                /* Top highlight */
                0 10px 30px rgba(0, 0, 0, 0.5),
                /* Drop shadow */
                0 0 0 1px rgba(0, 0, 0, 0.3),
                /* Dark outer rim */
                0 20px 50px rgba(0, 0, 0, 0.5);
            /* Ambient shadow */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);

            /* Beveled edges via shadows/borders */
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            /* Catch light */
            border-left: 1px solid rgba(255, 255, 255, 0.3);
            /* Catch light */
        }

        /* Inner inset for screen look */
        .counter-box::before {
            content: '';
            position: absolute;
            inset: 10px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.2);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        .counter-val {
            font-family: 'Rajdhani', sans-serif;
            font-size: 8rem;
            font-weight: 700;
            line-height: 1;
            color: #fff;
            text-shadow:
                0 1px 0 #ccc,
                0 2px 0 #c9c9c9,
                0 3px 0 #bbb,
                0 4px 0 #b9b9b9,
                0 5px 0 #aaa,
                0 6px 1px rgba(0, 0, 0, .1),
                0 0 5px rgba(0, 0, 0, .1),
                0 1px 3px rgba(0, 0, 0, .3),
                0 3px 5px rgba(0, 0, 0, .2),
                0 5px 10px rgba(0, 0, 0, .25),
                0 10px 10px rgba(0, 0, 0, .2),
                0 20px 20px rgba(0, 0, 0, .15),
                0 0 20px var(--shadow-light);
            text-align: center;
            transition: transform 0.1s;
            position: relative;
        }

        .counter-val.pulse {
            transform: scale(1.05);
            text-shadow:
                0 0 30px var(--primary),
                0 0 60px var(--secondary);
            /* Simplistic stack reset for pulse to avoid heavy calculation glitch, or just add glow */
        }

        .counter-label {
            margin-top: 1rem;
            font-size: 1rem;
            opacity: 0.6;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Controls */
        .controls-area {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            align-items: center;
        }

        .plus-btn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.08);
            /* More glass */
            border: 1px solid rgba(255, 255, 255, 0.3);
            /* Brighter border */
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            color: #fff;
            font-size: 3rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow:
                0 15px 35px rgba(0, 0, 0, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.1),
                /* Stronger inner glow */
                0 0 20px var(--shadow-light);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            /* Bouncy */
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }

        .plus-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: sheen 3s infinite;
        }

        @keyframes sheen {
            0% {
                transform: translateX(-100%) rotate(45deg);
            }

            100% {
                transform: translateX(100%) rotate(45deg);
            }
        }

        .plus-btn:active {
            transform: scale(0.92);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5), 0 0 5px var(--shadow-light);
        }

        /* Secondary Controls Panel */
        .secondary-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            width: 100%;
        }

        .control-btn {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            /* Top light highlight */
            border-radius: 16px;
            padding: 18px;
            color: #fff;
            font-family: 'Outfit', sans-serif;
            font-weight: 500;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-btn:active {
            background: rgba(255, 255, 255, 0.1);
        }

        .btn-reset {
            color: var(--danger);
            border-color: rgba(255, 42, 109, 0.3);
        }

        .btn-auto {
            color: var(--primary);
            border-color: rgba(0, 243, 255, 0.3);
        }

        .btn-auto.active {
            background: rgba(0, 243, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }

        /* Intro Screen */
        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            transition: opacity 0.8s ease-out;
        }

        .intro-logo {
            font-family: 'Rajdhani', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            color: #fff;
            letter-spacing: 4px;
            opacity: 0;
            animation: introReveal 2s ease-out forwards;
        }

        .intro-logo span {
            color: var(--primary);
        }

        @keyframes introReveal {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }

            40% {
                opacity: 1;
                transform: scale(1.1) translateY(0);
            }

            60% {
                transform: scale(1);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .intro-loader {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            margin-top: 30px;
            animation: spin 1s linear infinite;
            opacity: 0;
            animation-delay: 0.5s;
            animation-fill-mode: forwards;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Calibration Overlay / Message */
        .message-toast {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -20%);
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 0.9rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            text-align: center;
            width: 80%;
            z-index: 100;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
        }

        .message-toast.show {
            opacity: 1;
        }

        /* Auto Controls (Hidden by default) */
        .auto-controls {
            display: none;
            /* Flex when active */
            width: 100%;
            justify-content: center;
            gap: 1rem;
        }

        .btn-stop-auto {
            background: rgba(255, 42, 109, 0.1);
            color: var(--danger);
            border-color: var(--danger);
            flex-grow: 1;
        }

        /* Instruction Text */
        .instruction {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.4);
            text-align: center;
            min-height: 1.2rem;
        }

        /* Responsive adjustments for very small screens */
        @media (max-height: 600px) {
            .counter-val {
                font-size: 6rem;
            }

            .plus-btn {
                width: 80px;
                height: 80px;
            }
        }

        /* Ripple Effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        /* Reset Button Long Press Animation */
        .btn-reset {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn-reset::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0%;
            height: 100%;
            background: rgba(255, 42, 109, 0.4);
            transition: width 0s;
            z-index: -1;
        }

        .btn-reset.pressing::before {
            width: 100%;
            transition: width 0.8s linear;
        }

        /* Custom Dialogs */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            z-index: 1000;
            display: flex;
            box-sizing: border-box;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            padding: 20px;
        }

        .dialog-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .dialog-card {
            background: rgba(10, 10, 20, 0.95);
            border: 1px solid var(--primary);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
            border-radius: 24px;
            padding: 30px;
            width: 100%;
            max-width: 350px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .dialog-overlay.active .dialog-card {
            transform: scale(1);
        }

        .dialog-title {
            font-family: 'Rajdhani';
            font-size: 1.8rem;
            font-weight: 700;
            color: #fff;
            margin: 0;
        }

        .dialog-msg {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
        }

        .dialog-input {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: #fff;
            font-family: 'Outfit';
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
            display: none;
            /* Hidden by default */
        }

        .dialog-input:focus {
            border-color: var(--primary);
        }

        .dialog-input.visible {
            display: block;
        }

        .dialog-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        .dialog-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Outfit';
            transition: transform 0.2s, filter 0.2s;
        }

        .dialog-btn:active {
            transform: scale(0.95);
        }

        .dialog-btn-cancel {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.7);
        }

        .dialog-btn-confirm {
            background: var(--primary);
            color: #000;
            box-shadow: 0 0 15px var(--shadow-light);
        }

        .dialog-btn-danger {
            background: var(--danger);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 42, 109, 0.4);
        }
    </style>
</head>

<body>
    <!-- Intro Screen -->
    <div id="intro-screen">
        <div class="intro-logo">PULSE<span>COUNT</span></div>
        <div class="intro-loader"></div>
    </div>

    <div class="background-fx">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="scanlines"></div>
    </div>

    <div class="app-container">
        <header>
            <div class="logo">Pulse<span style="color:var(--primary)">Count</span></div>

            <div class="header-controls">
                <div class="status-badge" id="autoStatus">
                    <div class="indicator-dot"></div>
                    <span id="autoStatusText">AUTO</span>
                </div>
                <button class="icon-btn" id="btnHistory"><i class="fa-solid fa-clock-rotate-left"></i></button>
                <button class="icon-btn" id="btnSettings"><i class="fa-solid fa-gear"></i></button>
            </div>
        </header>

        <!-- Modals -->
        <div class="modal-overlay" id="historyModal">
            <div class="modal-card">
                <div class="modal-header">
                    <span class="modal-title">History</span>
                    <div class="history-actions">
                        <button class="btn-select-history" id="btnSelectHistory">Select</button>
                        <button class="btn-delete-selected" id="btnDeleteSelected">Delete (0)</button>
                    </div>
                    <button class="close-btn" onclick="toggleModal('historyModal')">&times;</button>
                </div>
                <button class="control-btn" id="btnClearHistory"
                    style="width:100%; margin-bottom:10px; font-size:0.8rem; padding:10px;">Clear History</button>
                <ul class="history-list" id="historyList">
                    <li style="text-align:center; opacity:0.5;">No history yet</li>
                </ul>
            </div>
        </div>

        <div class="modal-overlay" id="settingsModal">
            <div class="modal-card">
                <div class="modal-header">
                    <span class="modal-title">Settings</span>
                    <button class="close-btn" onclick="toggleModal('settingsModal')">&times;</button>
                </div>

                <h4 style="margin-top:0">Set Goal</h4>
                <div class="goal-input-group">
                    <input type="number" id="goalInput" class="goal-input" placeholder="0 = No Goal">
                    <button class="control-btn" id="btnSaveGoal" style="padding: 10px 20px;">Set</button>
                </div>

                <h4>Theme</h4>
                <div class="theme-grid">
                    <div class="theme-opt" onclick="setTheme('neon')">Neon</div>
                    <div class="theme-opt" onclick="setTheme('forest')">Forest</div>
                    <div class="theme-opt" onclick="setTheme('ember')">Ember</div>
                    <div class="theme-opt" onclick="setTheme('gold')">Gold</div>
                    <div class="theme-opt" onclick="setTheme('light')" style="background:#f0f2f5; color:#333;">Light
                    </div>
                </div>
            </div>
        </div>

        <!-- Custom Dialog -->
        <div class="dialog-overlay" id="customDialogOverlay">
            <div class="dialog-card">
                <h3 class="dialog-title" id="cdTitle">Alert</h3>
                <p class="dialog-msg" id="cdMsg">Message goes here</p>
                <input type="text" id="cdInput" class="dialog-input" placeholder="Type here...">
                <div class="dialog-actions" id="cdActions">
                    <!-- Buttons injected via JS -->
                </div>
            </div>
        </div>

        <div class="message-toast" id="toast"></div>

        <div class="counter-wrapper">
            <div class="counter-box">
                <div class="counter-val" id="countDisplay">0</div>
                <div class="counter-label" id="speedDisplay">MANUAL MODE</div>
            </div>
        </div>

        <div class="controls-area">

            <div class="instruction" id="instructionText">Long press Reset to clear</div>

            <!-- Main Interaction Button -->
            <div class="plus-btn-container">
                <svg class="progress-ring" width="120" height="120">
                    <circle class="progress-ring__circle" stroke="var(--primary)" stroke-width="4" fill="transparent"
                        r="52" cx="60" cy="60" style="stroke-dasharray: 326.7; stroke-dashoffset: 326.7;"></circle>
                </svg>
                <button class="plus-btn" id="btnPlus" aria-label="Increment">
                    <i class="fa-solid fa-plus"></i>
                </button>
            </div>

            <!-- Standard Controls -->
            <div class="secondary-controls" id="stdControls">
                <button class="control-btn btn-reset" id="btnReset">
                    <i class="fa-solid fa-rotate-left"></i> Reset
                </button>
                <button class="control-btn btn-auto" id="btnAuto">
                    <i class="fa-solid fa-robot"></i> Smart Auto
                </button>
            </div>

            <!-- Auto Running Controls -->
            <div class="secondary-controls auto-controls" id="autoRunControls">
                <button class="control-btn" id="btnPauseResume">
                    <i class="fa-solid fa-pause"></i> Pause
                </button>
                <button class="control-btn btn-stop-auto" id="btnStopAuto">
                    <i class="fa-solid fa-stop"></i> Stop
                </button>
            </div>

        </div>
    </div>

    <script>
        // State
        let count = 0;
        let mode = 'MANUAL'; // MANUAL, CALIB, AUTO_RUNNING, AUTO_PAUSED
        let calibrationTaps = [];
        let autoIntervalMs = 1000;
        let autoTimer = null;
        let resetTimer = null; // For long press
        let goal = 0;
        let history = [];
        let sessionStartTime = Date.now();
        let currentTheme = 'neon';
        let isSelecting = false;
        let selectedSessions = new Set();
        let audioCtx = null;

        // DOM Elements
        const countDisplay = document.getElementById('countDisplay');
        const btnPlus = document.getElementById('btnPlus');
        const btnReset = document.getElementById('btnReset');
        const btnAuto = document.getElementById('btnAuto');
        const btnPauseResume = document.getElementById('btnPauseResume');
        const btnStopAuto = document.getElementById('btnStopAuto');

        // New DOM Elements
        const btnHistory = document.getElementById('btnHistory');
        const btnSettings = document.getElementById('btnSettings');
        const historyList = document.getElementById('historyList');
        const btnClearHistory = document.getElementById('btnClearHistory');
        const btnSelectHistory = document.getElementById('btnSelectHistory');
        const btnDeleteSelected = document.getElementById('btnDeleteSelected');
        const goalInput = document.getElementById('goalInput');
        const btnSaveGoal = document.getElementById('btnSaveGoal');
        const progressRingCircle = document.querySelector('.progress-ring__circle');

        // Dialog Elements
        const dialogOverlay = document.getElementById('customDialogOverlay');
        const cdTitle = document.getElementById('cdTitle');
        const cdMsg = document.getElementById('cdMsg');
        const cdInput = document.getElementById('cdInput');
        const cdActions = document.getElementById('cdActions');

        const stdControls = document.getElementById('stdControls');
        const autoRunControls = document.getElementById('autoRunControls');

        const autoStatus = document.getElementById('autoStatus');
        const autoStatusText = document.getElementById('autoStatusText');
        const speedDisplay = document.getElementById('speedDisplay');
        const instructionText = document.getElementById('instructionText');
        const toast = document.getElementById('toast');

        // Init
        function init() {
            const saved = localStorage.getItem('tally3d_count');
            const savedGoal = localStorage.getItem('tally3d_goal');
            const savedHistory = localStorage.getItem('tally3d_history');
            const savedTheme = localStorage.getItem('tally3d_theme');

            if (saved) count = parseInt(saved, 10);
            if (savedGoal) {
                goal = parseInt(savedGoal, 10);
                if (goalInput) goalInput.value = goal;
            }
            if (savedHistory) {
                history = JSON.parse(savedHistory);
                renderHistory();
            }
            if (savedTheme) setTheme(savedTheme);

            updateDisplay(false);
            updateProgressRing();

            // PWA Logic
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').then(() => console.log('SW Registered'));
            }

            // Intro Screen Logic
            setTimeout(() => {
                const intro = document.getElementById('intro-screen');
                if (intro) {
                    intro.style.opacity = '0';
                    setTimeout(() => intro.style.display = 'none', 800);
                }
            }, 2000); // 2 seconds total intro time
        }

        // Helpers
        function save() {
            localStorage.setItem('tally3d_count', count);
        }

        function updateDisplay(animate = true) {
            if (animate) {
                // 3D Flip Animation - Optimized for speed
                countDisplay.style.transition = 'transform 0.08s ease-in, opacity 0.08s';
                countDisplay.style.transform = 'rotateX(90deg)';
                countDisplay.style.opacity = '0.5';

                setTimeout(() => {
                    countDisplay.innerText = count;
                    countDisplay.style.transition = 'transform 0.08s ease-out, opacity 0.08s';
                    countDisplay.style.transform = 'rotateX(0deg)';
                    countDisplay.style.opacity = '1';
                }, 80);
            } else {
                countDisplay.innerText = count;
            }
        }

        function showToast(msg, duration = 2000) {
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), duration);
        }

        // Sound Engine


        // Sound Engine
        function playGoalSound() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();

            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();

            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1); // A5

            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);

            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function switchMode(newMode) {
            mode = newMode;

            // Reset visual states
            autoStatus.classList.remove('visible');
            stdControls.style.display = 'grid';
            autoRunControls.style.display = 'none';
            btnPlus.style.opacity = '1';
            btnPlus.style.pointerEvents = 'auto';
            document.documentElement.style.setProperty('--primary', '#00f3ff');

            if (mode === 'MANUAL') {
                speedDisplay.innerText = "MANUAL MODE";
                instructionText.innerText = "Long press Reset to clear";
            } else if (mode === 'CALIB') {
                calibrationTaps = [];
                speedDisplay.innerText = "CALIBRATION MODE";
                showToast("Tap (+) 3 times to set speed", 3000);
                instructionText.innerText = "Tap 1/3";
                document.documentElement.style.setProperty('--primary', '#ffaa00'); // Orange for calib
            } else if (mode === 'AUTO_RUNNING') {
                stdControls.style.display = 'none';
                autoRunControls.style.display = 'flex';
                autoStatus.classList.add('visible');
                autoStatusText.innerText = "RUNNING";
                btnPlus.style.opacity = '0.5'; // Dim the plus button
                // btnPlus.style.pointerEvents = 'none'; // Optional: disable manual tap during auto? Or allow "extra" taps? Req says "Disable reset", imply safety. Let's allow manual tap addition but maybe discouraged. User asked to "Prevent accidental taps" in Safety. Let's keep manual tap active but maybe delay protected?
                // Actually, UX: if auto is running, manual tap adds to it.
                instructionText.innerText = "Auto-counting active";

                // Show speed
                const speedSec = (autoIntervalMs / 1000).toFixed(2);
                speedDisplay.innerText = `${speedSec}s / tap`;

                startAutoTimer();
            } else if (mode === 'AUTO_PAUSED') {
                stdControls.style.display = 'none';
                autoRunControls.style.display = 'flex';
                autoStatus.classList.add('visible');
                autoStatusText.innerText = "PAUSED";
                clearInterval(autoTimer);
                btnPauseResume.innerHTML = '<i class="fa-solid fa-play"></i> Resume';
            }
        }

        // Logic
        function increment() {
            count++;

            // Visual Haptics: Bounce
            countDisplay.style.transform = 'scale(1.1)';
            setTimeout(() => countDisplay.style.transform = 'scale(1)', 100);

            // Goal Check
            if (goal > 0 && count === goal) {
                showToast("Goal Reached! ðŸŽ‰", 4000);
                playGoalSound();
                if (navigator.vibrate) navigator.vibrate([100, 50, 100, 50, 200]);
                // Celebration
                document.body.classList.add('milestone-hit');
                setTimeout(() => document.body.classList.remove('milestone-hit'), 2000);
            }

            // Milestone Effect
            if (count % 100 === 0 && count > 0) {
                document.body.classList.add('milestone-hit');
                if (navigator.vibrate) navigator.vibrate(200);
                setTimeout(() => document.body.classList.remove('milestone-hit'), 1500);
            }

            save();
            updateDisplay();
            updateProgressRing();

            // Haptic feedback if available
            if (navigator.vibrate) navigator.vibrate(10);
        }

        function updateProgressRing() {
            if (!progressRingCircle) return;
            const radius = 52;
            const circumference = radius * 2 * Math.PI;
            progressRingCircle.style.strokeDasharray = `${circumference} ${circumference}`;

            let percent = 0;
            if (goal > 0) percent = Math.min(100, (count / goal) * 100);
            else percent = (count % 100); // Visual flair loop if no goal

            const offset = circumference - (percent / 100) * circumference;
            progressRingCircle.style.strokeDashoffset = offset;
        }

        function handlePlusClick(e) {
            // Ripple effect
            const circle = document.createElement('div');
            const diameter = Math.max(btnPlus.clientWidth, btnPlus.clientHeight);
            const radius = diameter / 2;

            // Calculate click pos relative to button
            const rect = btnPlus.getBoundingClientRect();
            // Handle both mouse and touch
            const clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            const clientY = e.clientY || (e.touches ? e.touches[0].clientY : 0);

            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${clientX - rect.left - radius}px`;
            circle.style.top = `${clientY - rect.top - radius}px`;
            circle.classList.add('ripple');

            const ripple = btnPlus.getElementsByClassName('ripple')[0];
            if (ripple) {
                ripple.remove();
            }
            btnPlus.appendChild(circle);

            // Logic based on mode
            if (mode === 'MANUAL' || mode === 'AUTO_RUNNING' || mode === 'AUTO_PAUSED') {
                increment();
            } else if (mode === 'CALIB') {
                increment();
                const now = Date.now();
                calibrationTaps.push(now);

                if (calibrationTaps.length === 1) {
                    instructionText.innerText = "Tap 2/3";
                } else if (calibrationTaps.length === 2) {
                    instructionText.innerText = "Tap 3/3";
                } else if (calibrationTaps.length === 3) {
                    // Calculate
                    const t1 = calibrationTaps[0];
                    const t2 = calibrationTaps[1];
                    const t3 = calibrationTaps[2];

                    const i1 = t2 - t1;
                    const i2 = t3 - t2;
                    const avg = (i1 + i2) / 2;

                    // Safety: limit min speed
                    autoIntervalMs = Math.max(100, avg);

                    // Transition to Auto
                    switchMode('AUTO_RUNNING');
                    showToast(`Speed set: ${(autoIntervalMs / 1000).toFixed(2)}s`);
                }
            }
        }

        function startAutoTimer() {
            clearInterval(autoTimer);
            btnPauseResume.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
            autoTimer = setInterval(() => {
                increment();
            }, autoIntervalMs);
        }

        // Event Listeners
        btnPlus.addEventListener('click', handlePlusClick);
        // Mobile optimization: prevent double tap zoom and ensure fast response
        btnPlus.addEventListener('touchstart', (e) => {
            e.preventDefault(); // prevents mouse emulation, but we must call handlePlusClick manually
            handlePlusClick(e);
        }, { passive: false });


        // Auto Button
        btnAuto.addEventListener('click', () => {
            if (mode === 'MANUAL') {
                switchMode('CALIB');
            } else {
                switchMode('MANUAL'); // Cancel if clicked again (though hidden usually)
            }
        });

        // Reset with Long Press
        btnReset.addEventListener('mousedown', startResetTimer);
        btnReset.addEventListener('touchstart', startResetTimer, { passive: false });
        btnReset.addEventListener('mouseup', clearResetTimer);
        btnReset.addEventListener('mouseleave', clearResetTimer);
        btnReset.addEventListener('touchend', clearResetTimer);

        function startResetTimer(e) {
            if (mode !== 'MANUAL') return;
            if (e.type === 'touchstart') e.preventDefault();

            // Visual feedback start
            btnReset.classList.add('pressing');

            resetTimer = setTimeout(async () => {
                // Save Session logic
                if (count > 0) {
                    // Using Custom Dialog
                    const result = await Dialog.prompt({
                        title: "Save Session?",
                        message: "Do you want to save this count before resetting?",
                        inputValue: `Session ${history.length + 1}`,
                        confirmText: "Save",
                        cancelText: "Don't Save"
                    });

                    if (result) { // If confirmed (result is the string name)
                        const session = {
                            id: Date.now(),
                            name: result || `Session ${history.length + 1}`,
                            val: count,
                            date: new Date().toLocaleString()
                        };
                        history.unshift(session);
                        localStorage.setItem('tally3d_history', JSON.stringify(history));
                        renderHistory();
                        showToast("Session Saved");
                    }
                }

                // Action triggered
                count = 0;
                sessionStartTime = Date.now(); // Reset time
                save();
                updateDisplay();
                updateProgressRing();

                if (navigator.vibrate) navigator.vibrate([50, 50, 50]);
                btnReset.classList.remove('pressing');
            }, 800); // 800ms long press
        }

        function clearResetTimer() {
            clearTimeout(resetTimer);
            btnReset.classList.remove('pressing');
        }

        // Modal Logic
        function toggleModal(id) {
            const el = document.getElementById(id);
            if (el.classList.contains('open')) {
                el.classList.remove('open');
            } else {
                document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('open'));
                el.classList.add('open');
            }
        }

        btnHistory.addEventListener('click', () => toggleModal('historyModal'));
        btnSettings.addEventListener('click', () => toggleModal('settingsModal'));

        btnSaveGoal.addEventListener('click', () => {
            const val = parseInt(goalInput.value, 10);
            if (!isNaN(val) && val >= 0) {
                goal = val;
                localStorage.setItem('tally3d_goal', goal);
                showToast(goal > 0 ? `Goal set: ${goal}` : "Goal cleared");
                updateProgressRing();
                toggleModal('settingsModal');
            }
        });

        btnClearHistory.addEventListener('click', async () => {
            const confirmed = await Dialog.confirm({
                title: "Clear History",
                message: "Are you sure you want to delete all saved sessions? This cannot be undone.",
                confirmText: "Delete All",
                isDanger: true
            });

            if (confirmed) {
                history = [];
                localStorage.setItem('tally3d_history', JSON.stringify([]));
                renderHistory();
                showToast("History Cleared");
                toggleModal('historyModal');
            }
        });

        // Dialog Utility
        const Dialog = {
            confirm: ({ title, message, confirmText = 'Confirm', cancelText = 'Cancel', isDanger = false }) => {
                return new Promise(resolve => {
                    cdTitle.innerText = title;
                    cdMsg.innerText = message;
                    cdInput.classList.remove('visible');
                    cdActions.innerHTML = '';

                    const btnCancel = document.createElement('button');
                    btnCancel.className = 'dialog-btn dialog-btn-cancel';
                    btnCancel.innerText = cancelText;
                    btnCancel.onclick = () => { closeDialog(); resolve(false); };

                    const btnConfirm = document.createElement('button');
                    btnConfirm.className = `dialog-btn ${isDanger ? 'dialog-btn-danger' : 'dialog-btn-confirm'}`;
                    btnConfirm.innerText = confirmText;
                    btnConfirm.onclick = () => { closeDialog(); resolve(true); };

                    cdActions.append(btnCancel, btnConfirm);
                    dialogOverlay.classList.add('active');
                });
            },
            prompt: ({ title, message, inputValue = '', confirmText = 'OK', cancelText = 'Cancel' }) => {
                return new Promise(resolve => {
                    cdTitle.innerText = title;
                    cdMsg.innerText = message;
                    cdInput.value = inputValue;
                    cdInput.classList.add('visible');
                    cdActions.innerHTML = '';

                    const btnCancel = document.createElement('button');
                    btnCancel.className = 'dialog-btn dialog-btn-cancel';
                    btnCancel.innerText = cancelText;
                    btnCancel.onclick = () => { closeDialog(); resolve(null); };

                    const btnConfirm = document.createElement('button');
                    btnConfirm.className = 'dialog-btn dialog-btn-confirm';
                    btnConfirm.innerText = confirmText;
                    btnConfirm.onclick = () => {
                        const val = cdInput.value;
                        closeDialog();
                        resolve(val);
                    };

                    cdActions.append(btnCancel, btnConfirm);
                    dialogOverlay.classList.add('active');
                    cdInput.focus();
                });
            }
        };

        function closeDialog() {
            dialogOverlay.classList.remove('active');
        }

        function renderHistory() {
            historyList.innerHTML = '';
            // CSS Class toggle
            if (isSelecting) historyList.classList.add('selecting');
            else historyList.classList.remove('selecting');

            if (history.length === 0) {
                historyList.innerHTML = '<li style="text-align:center; opacity:0.5;">No history yet</li>';
                return;
            }
            history.forEach(h => {
                const li = document.createElement('li');
                li.className = 'history-item';

                // Content
                let html = '';
                if (isSelecting) {
                    // Checkbox
                    html += `<input type="checkbox" class="history-check" data-id="${h.id}">`;
                }

                html += `
                    <div class="history-val" style="margin-left: ${isSelecting ? '0' : '0'}">${h.name}: ${h.val}</div>
                    <div class="history-meta"><span>${h.date}</span></div>
                `;
                li.innerHTML = html;

                // Evt
                if (isSelecting) {
                    const cb = li.querySelector('.history-check');
                    if (selectedSessions.has(h.id)) cb.checked = true;

                    cb.addEventListener('change', (e) => {
                        if (e.target.checked) selectedSessions.add(h.id);
                        else selectedSessions.delete(h.id);
                        updateDeleteBtn();
                    });
                    // Also click li to toggle
                    li.onclick = (e) => {
                        if (e.target.tagName !== 'INPUT') {
                            cb.checked = !cb.checked;
                            cb.dispatchEvent(new Event('change'));
                        }
                    }
                }

                historyList.appendChild(li);
            });
        }

        function setTheme(thm) {
            document.body.className = '';
            document.body.classList.add('theme-' + thm);
            localStorage.setItem('tally3d_theme', thm);
            // Visual feedback handled by CSS var change
            document.querySelectorAll('.theme-opt').forEach(el => {
                if (el.textContent.toLowerCase() === thm) el.classList.add('active');
                else el.classList.remove('active');
            });
        }

        // Auto Controls
        btnPauseResume.addEventListener('click', () => {
            if (mode === 'AUTO_RUNNING') {
                switchMode('AUTO_PAUSED');
            } else if (mode === 'AUTO_PAUSED') {
                switchMode('AUTO_RUNNING');
            }
        });

        btnStopAuto.addEventListener('click', () => {
            clearInterval(autoTimer);
            switchMode('MANUAL');
            showToast("Auto mode stopped");
        });

        // Initialize
        init();

    </script>
</body>

</html>